[15:39:51] Starting topbottom_olmo-7b_vit-l-14-336
[15:39:51] Running topbottom_olmo-7b_vit-l-14-336 layer 0...

============================================================
LLM Judge - CONTEXTUAL
Model: olmo-7b + vit-l-14-336
Layer: 0
Input: analysis_results/contextual_nearest_neighbors/ablations/train_mlp-only_pixmo_topbottom_olmo-7b_vit-l-14-336_step12000-unsharded/contextual_neighbors_visual0_allLayers.json
Output: analysis_results/llm_judge_contextual_nn/ablations/llm_judge_topbottom_olmo-7b_vit-l-14-336_contextual0_gpt5_cropped
============================================================

Processing images:   0%|          | 0/100 [00:00<?, ?it/s]Processing images:   1%|          | 1/100 [00:08<14:46,  8.95s/it]Processing images:   2%|▏         | 2/100 [00:31<27:38, 16.93s/it]Processing images:   3%|▎         | 3/100 [00:43<23:24, 14.48s/it]Processing images:   4%|▍         | 4/100 [00:55<22:01, 13.76s/it]Processing images:   5%|▌         | 5/100 [01:06<20:00, 12.64s/it]Processing images:   6%|▌         | 6/100 [01:17<19:01, 12.14s/it]Processing images:   7%|▋         | 7/100 [01:32<20:15, 13.07s/it]Processing images:   8%|▊         | 8/100 [01:47<20:46, 13.55s/it]Processing images:   9%|▉         | 9/100 [01:59<20:07, 13.27s/it]Processing images:  10%|█         | 10/100 [02:07<17:18, 11.53s/it]Processing images:  11%|█         | 11/100 [02:26<20:43, 13.97s/it]Processing images:  12%|█▏        | 12/100 [02:40<20:33, 14.02s/it]Processing images:  13%|█▎        | 13/100 [02:51<18:50, 12.99s/it]Processing images:  14%|█▍        | 14/100 [03:05<19:04, 13.31s/it]Processing images:  15%|█▌        | 15/100 [03:15<17:32, 12.38s/it]Processing images:  16%|█▌        | 16/100 [03:27<16:49, 12.02s/it]Processing images:  17%|█▋        | 17/100 [03:40<17:15, 12.47s/it]Processing images:  18%|█▊        | 18/100 [03:49<15:31, 11.36s/it]Processing images:  19%|█▉        | 19/100 [04:02<15:59, 11.85s/it]Processing images:  20%|██        | 20/100 [04:10<14:23, 10.80s/it]Processing images:  21%|██        | 21/100 [04:31<18:01, 13.69s/it]Processing images:  22%|██▏       | 22/100 [04:44<17:33, 13.51s/it]Processing images:  23%|██▎       | 23/100 [04:53<15:46, 12.29s/it]Processing images:  24%|██▍       | 24/100 [05:03<14:26, 11.40s/it]Processing images:  25%|██▌       | 25/100 [05:13<13:47, 11.04s/it]Processing images:  26%|██▌       | 26/100 [05:27<14:38, 11.88s/it]Processing images:  27%|██▋       | 27/100 [05:41<15:18, 12.58s/it]Processing images:  28%|██▊       | 28/100 [05:50<13:50, 11.53s/it]Processing images:  29%|██▉       | 29/100 [06:02<13:54, 11.75s/it]Processing images:  30%|███       | 30/100 [06:27<18:11, 15.59s/it]Processing images:  31%|███       | 31/100 [06:36<15:46, 13.72s/it]Processing images:  32%|███▏      | 32/100 [06:46<14:25, 12.73s/it]Processing images:  33%|███▎      | 33/100 [07:00<14:31, 13.01s/it]Processing images:  34%|███▍      | 34/100 [07:19<16:13, 14.75s/it]Processing images:  35%|███▌      | 35/100 [07:30<14:41, 13.56s/it]Processing images:  36%|███▌      | 36/100 [07:43<14:20, 13.44s/it]Processing images:  37%|███▋      | 37/100 [07:58<14:43, 14.03s/it]Processing images:  38%|███▊      | 38/100 [08:07<12:55, 12.51s/it]Processing images:  39%|███▉      | 39/100 [08:16<11:25, 11.24s/it]Processing images:  40%|████      | 40/100 [08:24<10:27, 10.45s/it]Processing images:  41%|████      | 41/100 [08:34<10:01, 10.20s/it]Processing images:  42%|████▏     | 42/100 [09:06<16:08, 16.71s/it]Processing images:  43%|████▎     | 43/100 [09:15<13:52, 14.61s/it]Processing images:  44%|████▍     | 44/100 [09:29<13:20, 14.30s/it]Processing images:  45%|████▌     | 45/100 [09:41<12:34, 13.72s/it]Processing images:  46%|████▌     | 46/100 [09:49<10:45, 11.95s/it]Processing images:  47%|████▋     | 47/100 [10:08<12:16, 13.89s/it]Processing images:  48%|████▊     | 48/100 [10:19<11:26, 13.20s/it]Processing images:  49%|████▉     | 49/100 [10:27<09:59, 11.75s/it]Processing images:  50%|█████     | 50/100 [10:37<09:13, 11.07s/it]Processing images:  51%|█████     | 51/100 [10:53<10:10, 12.46s/it]Processing images:  52%|█████▏    | 52/100 [11:04<09:44, 12.18s/it]Processing images:  53%|█████▎    | 53/100 [11:19<10:06, 12.91s/it]Processing images:  54%|█████▍    | 54/100 [11:30<09:25, 12.29s/it]Processing images:  55%|█████▌    | 55/100 [11:54<12:01, 16.04s/it]Processing images:  56%|█████▌    | 56/100 [12:03<10:02, 13.70s/it]Processing images:  57%|█████▋    | 57/100 [12:14<09:19, 13.02s/it]Processing images:  58%|█████▊    | 58/100 [12:19<07:28, 10.67s/it]Processing images:  59%|█████▉    | 59/100 [12:38<08:56, 13.09s/it]Processing images:  60%|██████    | 60/100 [12:46<07:36, 11.42s/it]Processing images:  61%|██████    | 61/100 [12:57<07:20, 11.29s/it]Processing images:  62%|██████▏   | 62/100 [13:10<07:33, 11.93s/it]Processing images:  63%|██████▎   | 63/100 [13:20<06:54, 11.21s/it]Processing images:  64%|██████▍   | 64/100 [13:26<05:56,  9.89s/it]Processing images:  65%|██████▌   | 65/100 [13:34<05:27,  9.37s/it]Processing images:  66%|██████▌   | 66/100 [14:40<14:50, 26.18s/it]Processing images:  67%|██████▋   | 67/100 [14:48<11:23, 20.71s/it]Processing images:  68%|██████▊   | 68/100 [14:56<09:01, 16.93s/it]Processing images:  69%|██████▉   | 69/100 [15:04<07:20, 14.21s/it]Processing images:  70%|███████   | 70/100 [15:16<06:47, 13.58s/it]Processing images:  71%|███████   | 71/100 [15:30<06:40, 13.80s/it]Processing images:  72%|███████▏  | 72/100 [15:38<05:39, 12.12s/it]Processing images:  73%|███████▎  | 73/100 [15:48<05:10, 11.49s/it]Processing images:  74%|███████▍  | 74/100 [16:01<05:09, 11.90s/it]Processing images:  75%|███████▌  | 75/100 [16:07<04:09,  9.97s/it]Processing images:  76%|███████▌  | 76/100 [16:16<03:54,  9.76s/it]Processing images:  77%|███████▋  | 77/100 [16:27<03:50, 10.03s/it]Processing images:  78%|███████▊  | 78/100 [16:35<03:26,  9.39s/it]Processing images:  79%|███████▉  | 79/100 [16:47<03:36, 10.31s/it]Processing images:  80%|████████  | 80/100 [16:53<03:01,  9.06s/it]Processing images:  81%|████████  | 81/100 [17:08<03:22, 10.65s/it]Processing images:  82%|████████▏ | 82/100 [17:15<02:55,  9.73s/it]Processing images:  83%|████████▎ | 83/100 [17:23<02:35,  9.13s/it]Processing images:  84%|████████▍ | 84/100 [17:34<02:33,  9.58s/it]Processing images:  85%|████████▌ | 85/100 [17:43<02:22,  9.53s/it]Processing images:  86%|████████▌ | 86/100 [17:53<02:13,  9.55s/it]Processing images:  87%|████████▋ | 87/100 [18:01<02:00,  9.26s/it]Processing images:  88%|████████▊ | 88/100 [18:12<01:56,  9.67s/it]Processing images:  89%|████████▉ | 89/100 [18:22<01:49,  9.95s/it]Processing images:  90%|█████████ | 90/100 [18:39<01:59, 11.97s/it]Processing images:  91%|█████████ | 91/100 [18:49<01:42, 11.35s/it]Processing images:  92%|█████████▏| 92/100 [18:57<01:24, 10.51s/it]Processing images:  93%|█████████▎| 93/100 [19:09<01:14, 10.69s/it]Processing images:  94%|█████████▍| 94/100 [19:24<01:13, 12.17s/it]Processing images:  95%|█████████▌| 95/100 [19:34<00:57, 11.42s/it]Processing images:  96%|█████████▌| 96/100 [19:44<00:43, 10.96s/it]Processing images:  97%|█████████▋| 97/100 [20:00<00:37, 12.55s/it]Processing images:  98%|█████████▊| 98/100 [20:08<00:22, 11.18s/it]Processing images:  99%|█████████▉| 99/100 [20:24<00:12, 12.60s/it]Processing images: 100%|██████████| 100/100 [20:35<00:00, 12.16s/it]Processing images: 100%|██████████| 100/100 [20:35<00:00, 12.36s/it]
  Patch (13, 9): ['and', 'sky', 'and']... -> PASS
  Patch (3, 16): ['outside', 'cap.', 'and']... -> FAIL
  Patch (0, 12): ['cap.', '.', 'and']... -> FAIL
  Patch (10, 8): ['cap.', 'outside', 'distance']... -> FAIL
  Patch (8, 18): ['and', 'bike.', 'cap.']... -> FAIL
  Patch (8, 13): ['outside', 'pants.', 'cap.']... -> FAIL
  Patch (7, 13): ['cap.', 'pants.', 'almost']... -> PASS
  Patch (18, 3): ['distance', 'entire', 'wearing']... -> PASS
  Patch (3, 4): ['the', 'ketchup', 'z161']... -> PASS
  Patch (18, 13): ['cap.', 'distance', 'entire']... -> FAIL
  Patch (2, 18): ['cap.', 'on', 'pants.']... -> PASS
  Patch (13, 16): ['cap.', 'on', 'and']... -> FAIL
  Patch (9, 18): ['cap.', 'distance', 'distance']... -> FAIL
  Patch (5, 16): ['visitor', 'navigational', 'navigational']... -> PASS
  Patch (5, 15): ['bear\\', 'wood\\', 'today']... -> PASS
  Patch (3, 6): ['the', 'semi-sepia', 'that']... -> FAIL
  Patch (6, 14): ['white', 'ketchup', 'caked']... -> PASS
  Patch (10, 7): ['.', '.', '.']... -> FAIL
  Patch (15, 16): ['cap.', 'distance', 'side']... -> PASS
  Patch (14, 0): ['cap.', 'and', '.']... -> FAIL
  Patch (0, 13): ['z161', "who're", "i've"]... -> FAIL
  Patch (19, 6): ['and', 'bike.', 'san']... -> PASS
  Patch (9, 13): ['.', '.', 'cap.']... -> FAIL
  Patch (16, 15): ['distance', 'cap.', 'distance']... -> FAIL
  Patch (14, 16): ['and', 'cap.', 'on']... -> FAIL
  Patch (7, 2): ['the', 'z161', "who're"]... -> PASS
  Patch (14, 8): ['caked', 'ketchup', 'z161']... -> FAIL
  Patch (17, 15): ['cap.', 'pants.', 'chandelier']... -> FAIL
  Patch (7, 11): ['cap.', 'outside', 'on']... -> PASS
  Patch (15, 9): ['sesame', 'head.big', 'porch']... -> FAIL
  Patch (20, 5): ['a-frame', 'a-frame', 'judge']... -> FAIL
  Patch (0, 6): ['z161', "who're", "i've"]... -> FAIL
  Patch (17, 14): ['pastrami', 'angkor', 'cap.']... -> PASS
  Patch (5, 10): ['cap.', '.', 'on']... -> PASS
  Patch (14, 2): ['outside', 'cap.', 'outside']... -> PASS
  Patch (14, 10): ['on', 'cap.', 'everywhere']... -> FAIL
  Patch (7, 16): ['today', 'cap.', 'upper']... -> FAIL
  Patch (7, 15): ['cap.', 'wood\\', 'today']... -> FAIL
  Patch (8, 13): ['perimeter', 'distance', 'and']... -> FAIL
  Patch (8, 0): ['z161', "who're", "i've"]... -> FAIL
  Patch (20, 12): ['on', 'and', 'bike.']... -> FAIL
  Patch (11, 11): ['cap.', '.', 'pants.']... -> FAIL
  Patch (6, 8): ['and', 'on', 'and']... -> FAIL
  Patch (6, 3): ['z161', "who're", 'semi-sepia']... -> PASS
  Patch (10, 18): ['cap.', 'distance', 'and']... -> PASS
  Patch (6, 5): ['peels', 'speck', 'john']... -> FAIL
  Patch (10, 5): ['image', '.', 'image']... -> PASS
  Patch (14, 12): ['sky', 'sky', 'sky']... -> PASS
  Patch (13, 0): ['jeffrey', 'and', 'cap.']... -> FAIL
  Patch (11, 3): ['white', 'z161', 'ketchup']... -> PASS
  Patch (15, 8): ['cap.', 'brown', 'wearing']... -> PASS
  Patch (5, 0): ['and', 'vcr', 'veined']... -> FAIL
  Patch (14, 15): ['04', '.', 'today']... -> FAIL
  Patch (17, 10): ['z161', "who're", "i've"]... -> FAIL
  Patch (7, 9): ['on', 'cap.', 'outside']... -> PASS
  Patch (16, 16): ['description', 'sesame', 'photo']... -> PASS
  Patch (9, 17): ['cap.', 'outside', 'distance']... -> FAIL
  Patch (5, 18): ['prongs', 'mlb', 'prongs']... -> FAIL
  Patch (16, 18): ['cap.', 'distance', 'outside']... -> PASS
  Patch (9, 9): ['z161', "who're", "you'll"]... -> FAIL
  Patch (13, 9): ['cap.', 'distance', 'and']... -> PASS
  Patch (15, 9): ['cap.', 'wearing', 'outside']... -> PASS
  Patch (8, 7): ['cap.', 'distance', 'outside']... -> FAIL
  Patch (2, 8): ['except', 'head.big', 'on']... -> FAIL
  Patch (5, 1): ['on', 'pon', 'moniter']... -> FAIL
  Patch (13, 15): ['cap.', 'distance', 'and']... -> FAIL
  Patch (10, 7): ['beautiful', 'beautiful', 'beautiful']... -> PASS
  Patch (9, 17): ['upper', 'baileys', 'transparent']... -> FAIL
  Patch (6, 20): ['z161', "who're", 'semi-sepia']... -> FAIL
  Patch (15, 20): ['outside', 'cap.', 'distance']... -> PASS
  Patch (5, 10): ['white', 'cap.', 'top']... -> PASS
  Patch (3, 10): ['z161', 'the', 'semi-sepia']... -> FAIL
  Patch (8, 18): ['.', 'baileys', 'tan.']... -> PASS
  Patch (8, 14): ['.', '.', '.']... -> PASS
  Patch (15, 12): ['.', 'cap.', 'and']... -> FAIL
  Patch (17, 17): ['caked', 'cap.', 'curvy']... -> PASS
  Patch (12, 10): ['cap.', 'wearing', 'on']... -> FAIL
  Patch (4, 13): ['white', 'white.', 'closed.']... -> PASS
  Patch (13, 13): ['cap.', 'brown', 'magnets']... -> PASS
  Patch (11, 9): ['cap.', 'distance', 'pants.']... -> FAIL
  Patch (8, 16): ['cap.', 'perimeter', 'visitor']... -> PASS
  Patch (15, 12): ['z161', "who're", "i've"]... -> FAIL
  Patch (9, 2): ['cap.', 'almost', 'practically']... -> FAIL
  Patch (2, 15): ['cap.', 'nadalnews.com', 'today']... -> PASS
  Patch (18, 3): ['?', 'jeffrey', 'schmutz']... -> FAIL
  Patch (7, 8): ['webcam', 'webcam', 'webcam']... -> FAIL
  Patch (16, 9): ['on', 'distance', 'distance']... -> FAIL
  Patch (14, 10): ['head.big', 'nadalnews.com', 'sesame']... -> FAIL
  Patch (7, 11): ['angkor', 'jeffrey', 'polka']... -> FAIL
  Patch (7, 17): ['cap.', 'pants.', '.']... -> PASS
  Patch (14, 16): ['ground', 'and', 'ground']... -> PASS
  Patch (11, 9): ['schmutz', 'mr', '5008']... -> FAIL
  Patch (9, 7): ['on', 'cap.', 'on']... -> FAIL
  Patch (21, 17): ['outside', 'outside', 'distance']... -> PASS
  Patch (9, 2): ['z161', "who're", "i've"]... -> FAIL
  Patch (11, 5): ['the', 'white', 'ketchup']... -> PASS
  Patch (7, 14): ['cap.', 'wearing', 'distance']... -> FAIL
  Patch (7, 16): ['z161', 'kansas', "who're"]... -> PASS
  Patch (5, 16): ['z161', "who're", "i've"]... -> PASS
  Patch (12, 7): ['.', 'sky', 'cap.']... -> PASS

============================================================
Results: 43/100 (43.0%)
Saved to: analysis_results/llm_judge_contextual_nn/ablations/llm_judge_topbottom_olmo-7b_vit-l-14-336_contextual0_gpt5_cropped/results_validation.json
Visualizations: analysis_results/llm_judge_contextual_nn/ablations/llm_judge_topbottom_olmo-7b_vit-l-14-336_contextual0_gpt5_cropped/visualizations
============================================================

[16:00:34] ✓ topbottom_olmo-7b_vit-l-14-336 layer 0 done
[16:00:34] Running topbottom_olmo-7b_vit-l-14-336 layer 1...

============================================================
LLM Judge - CONTEXTUAL
Model: olmo-7b + vit-l-14-336
Layer: 1
Input: analysis_results/contextual_nearest_neighbors/ablations/train_mlp-only_pixmo_topbottom_olmo-7b_vit-l-14-336_step12000-unsharded/contextual_neighbors_visual1_allLayers.json
Output: analysis_results/llm_judge_contextual_nn/ablations/llm_judge_topbottom_olmo-7b_vit-l-14-336_contextual1_gpt5_cropped
============================================================

Processing images:   0%|          | 0/100 [00:00<?, ?it/s]Processing images:   0%|          | 0/100 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/llm_judge/run_llm_judge.py", line 794, in <module>
    main()
  File "/home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/llm_judge/run_llm_judge.py", line 657, in main
    for list_idx, image_data in tqdm(load_images_data(input_json, args.analysis_type, args.num_images),
  File "/home/nlp/users/bkroje/vl_embedding_spaces/env/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/llm_judge/run_llm_judge.py", line 469, in load_images_data
    for i, image_obj in enumerate(parser):
ijson.common.IncompleteJSONError: lexical error: invalid char in json text.
                         "similarity": NaN,                   "context
                     (right here) ------^

