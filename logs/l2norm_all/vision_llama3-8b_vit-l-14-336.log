================================================================================
Vision Token L2 Norm Across Layers (Single-GPU)
================================================================================

Checkpoint: molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336/step12000-unsharded
Dataset split: validation
Number of images: 10
Target layers: [0, 4, 8, 16, 24, 31]
Histogram bins: 50

Loading model from molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336/step12000-unsharded
Detected full checkpoint (31.44 GB)
Skipping pretrained weights loading (checkpoint contains all weights)
Loading checkpoint weights...
Loaded 669 parameter tensors from checkpoint
Moving model to GPU (fp16)...
Model loaded on device: cuda

Loading PixMo-Cap validation split...

Processing 10 images...
Processing images:   0%|          | 0/10 [00:00<?, ?it/s]Processing images:  10%|█         | 1/10 [00:01<00:16,  1.78s/it]Processing images:  20%|██        | 2/10 [00:02<00:10,  1.26s/it]Processing images:  30%|███       | 3/10 [00:05<00:13,  1.99s/it]Processing images:  40%|████      | 4/10 [00:09<00:16,  2.74s/it]Processing images:  50%|█████     | 5/10 [00:16<00:22,  4.47s/it]Processing images:  60%|██████    | 6/10 [00:19<00:15,  3.91s/it]Processing images:  70%|███████   | 7/10 [00:21<00:09,  3.07s/it]Processing images:  80%|████████  | 8/10 [00:22<00:05,  2.50s/it]Processing images:  90%|█████████ | 9/10 [00:24<00:02,  2.47s/it]Processing images: 100%|██████████| 10/10 [00:25<00:00,  1.91s/it]Processing images: 100%|██████████| 10/10 [00:25<00:00,  2.55s/it]

✓ Saving detailed results to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336_step12000-unsharded/l2norm_across_layers_detailed.json...
✓ Saving summary to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336_step12000-unsharded/l2norm_across_layers_summary.json...
✓ Saving raw values to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336_step12000-unsharded/l2norm_raw_values.json...

================================================================================
Summary: L2 Norm Statistics per Layer (Vision Tokens)
================================================================================
Layer      Mean            Std             Min             Max             Samples   
--------------------------------------------------------------------------------
0          626.7379        4705.8280       19.0411         109908.2500     5760      
4          626.3437        4705.8501       18.3859         109908.2500     5760      
8          621.5067        4706.1707       12.9319         109908.2500     5760      
16         612.5788        4706.6113       9.9403          109908.2266     5760      
24         612.5574        4706.2877       16.6818         109907.6016     5760      
31         620.5951        4705.2024       27.1994         109907.3438     5760      
================================================================================

✓ Analysis complete! Results saved to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336_step12000-unsharded
