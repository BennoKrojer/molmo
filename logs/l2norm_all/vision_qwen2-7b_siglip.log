================================================================================
Vision Token L2 Norm Across Layers (Single-GPU)
================================================================================

Checkpoint: molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_qwen2-7b_siglip/step12000-unsharded
Dataset split: validation
Number of images: 10
Target layers: [0, 4, 8, 16, 24, 27]
Histogram bins: 50

Loading model from molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_qwen2-7b_siglip/step12000-unsharded
Detected full checkpoint (30.49 GB)
Skipping pretrained weights loading (checkpoint contains all weights)
Loading checkpoint weights...
Loaded 639 parameter tensors from checkpoint
Moving model to GPU (fp16)...
Model loaded on device: cuda

Loading PixMo-Cap validation split...

Processing 10 images...
Processing images:   0%|          | 0/10 [00:00<?, ?it/s]Processing images:  10%|█         | 1/10 [00:00<00:08,  1.07it/s]Processing images:  20%|██        | 2/10 [00:01<00:06,  1.30it/s]Processing images:  30%|███       | 3/10 [00:02<00:05,  1.35it/s]Processing images:  40%|████      | 4/10 [00:02<00:04,  1.41it/s]Processing images:  50%|█████     | 5/10 [00:03<00:04,  1.24it/s]Processing images:  60%|██████    | 6/10 [00:04<00:03,  1.32it/s]Processing images:  70%|███████   | 7/10 [00:05<00:02,  1.38it/s]Processing images:  80%|████████  | 8/10 [00:05<00:01,  1.42it/s]Processing images:  90%|█████████ | 9/10 [00:06<00:00,  1.43it/s]Processing images: 100%|██████████| 10/10 [00:07<00:00,  1.43it/s]Processing images: 100%|██████████| 10/10 [00:07<00:00,  1.37it/s]

✓ Saving detailed results to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_siglip_step12000-unsharded/l2norm_across_layers_detailed.json...
✓ Saving summary to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_siglip_step12000-unsharded/l2norm_across_layers_summary.json...
✓ Saving raw values to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_siglip_step12000-unsharded/l2norm_raw_values.json...

================================================================================
Summary: L2 Norm Statistics per Layer (Vision Tokens)
================================================================================
Layer      Mean            Std             Min             Max             Samples   
--------------------------------------------------------------------------------
0          3956.1295       8552.9743       806.5839        231173.7031     7290      
4          3945.9635       8554.4536       794.9156        231187.9375     7290      
8          3915.4938       8557.0041       761.0447        231187.8750     7290      
16         3847.8579       8563.8779       682.2518        231193.8906     7290      
24         3808.1137       8570.9679       639.7316        231241.8594     7290      
27         3814.3527       8568.4537       698.8177        231220.9219     7290      
================================================================================

✓ Analysis complete! Results saved to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_siglip_step12000-unsharded
