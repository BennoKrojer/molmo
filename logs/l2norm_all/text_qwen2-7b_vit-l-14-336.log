================================================================================
Text Token L2 Norm Across Layers (Single-GPU)
================================================================================

Checkpoint: molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10/step12000-unsharded
Dataset split: validation
Number of images: 10
Target layers: [0, 4, 8, 16, 24, 27]
Histogram bins: 50

Loading model from molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10/step12000-unsharded
Detected full checkpoint (30.00 GB)
Skipping pretrained weights loading (checkpoint contains all weights)
Loading checkpoint weights...
Loaded 577 parameter tensors from checkpoint
Moving model to GPU (fp16)...
Model loaded on device: cuda

Special token IDs to exclude: [100257, 100278, 100279, 100280, 100281, 151643, 152064, 152065, 152066, 152067]
Loading PixMo-Cap validation split...

Processing 10 images...
Processing images:   0%|          | 0/10 [00:00<?, ?it/s]Processing images:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]Processing images:  20%|██        | 2/10 [00:01<00:06,  1.17it/s]Processing images:  30%|███       | 3/10 [00:02<00:05,  1.23it/s]Processing images:  40%|████      | 4/10 [00:03<00:05,  1.05it/s]Processing images:  50%|█████     | 5/10 [00:06<00:07,  1.55s/it]Processing images:  60%|██████    | 6/10 [00:07<00:05,  1.37s/it]Processing images:  70%|███████   | 7/10 [00:08<00:03,  1.22s/it]Processing images:  80%|████████  | 8/10 [00:09<00:02,  1.12s/it]Processing images:  90%|█████████ | 9/10 [00:10<00:01,  1.12s/it]Processing images: 100%|██████████| 10/10 [00:11<00:00,  1.05s/it]Processing images: 100%|██████████| 10/10 [00:11<00:00,  1.12s/it]

✓ Saving detailed results to analysis_results/sameToken_acrossLayers_text_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10_step12000-unsharded/text_l2norm_across_layers_detailed.json...
✓ Saving summary to analysis_results/sameToken_acrossLayers_text_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10_step12000-unsharded/text_l2norm_across_layers_summary.json...
✓ Saving raw values to analysis_results/sameToken_acrossLayers_text_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10_step12000-unsharded/text_l2norm_raw_values.json...

================================================================================
Summary: L2 Norm Statistics per Layer (Text Tokens)
================================================================================
Layer      Mean            Std             Min             Max             Samples   
--------------------------------------------------------------------------------
0          0.8010          0.0405          0.6619          0.9041          2373      
4          24.7385         5.5313          13.1033         57.5928         2373      
8          42.5057         5.5929          28.4128         68.7136         2373      
16         61.6848         5.9721          44.1836         96.3423         2373      
24         194.7826        15.9898         118.2572        251.0411        2373      
27         354.6790        21.2190         260.6020        420.9297        2373      
================================================================================

✓ Analysis complete! Results saved to analysis_results/sameToken_acrossLayers_text_l2norm/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10_step12000-unsharded
