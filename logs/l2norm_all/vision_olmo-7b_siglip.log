================================================================================
Vision Token L2 Norm Across Layers (Single-GPU)
================================================================================

Checkpoint: molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_olmo-7b_siglip/step12000-unsharded
Dataset split: validation
Number of images: 10
Target layers: [0, 4, 8, 16, 24, 31]
Histogram bins: 50

Loading model from molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_olmo-7b_siglip/step12000-unsharded
Detected full checkpoint (29.09 GB)
Skipping pretrained weights loading (checkpoint contains all weights)
Loading checkpoint weights...
Loaded 699 parameter tensors from checkpoint
Moving model to GPU (fp16)...
Model loaded on device: cuda

Loading PixMo-Cap validation split...

Processing 10 images...
Processing images:   0%|          | 0/10 [00:00<?, ?it/s]Processing images:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]Processing images:  20%|██        | 2/10 [00:02<00:07,  1.03it/s]Processing images:  30%|███       | 3/10 [00:02<00:06,  1.07it/s]Processing images:  40%|████      | 4/10 [00:03<00:05,  1.04it/s]Processing images:  50%|█████     | 5/10 [00:05<00:05,  1.09s/it]Processing images:  60%|██████    | 6/10 [00:05<00:03,  1.03it/s]Processing images:  70%|███████   | 7/10 [00:06<00:02,  1.10it/s]Processing images:  80%|████████  | 8/10 [00:07<00:01,  1.15it/s]Processing images:  90%|█████████ | 9/10 [00:08<00:00,  1.18it/s]Processing images: 100%|██████████| 10/10 [00:09<00:00,  1.12it/s]Processing images: 100%|██████████| 10/10 [00:09<00:00,  1.07it/s]

✓ Saving detailed results to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_olmo-7b_siglip_step12000-unsharded/l2norm_across_layers_detailed.json...
✓ Saving summary to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_olmo-7b_siglip_step12000-unsharded/l2norm_across_layers_summary.json...
✓ Saving raw values to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_olmo-7b_siglip_step12000-unsharded/l2norm_raw_values.json...

================================================================================
Summary: L2 Norm Statistics per Layer (Vision Tokens)
================================================================================
Layer      Mean            Std             Min             Max             Samples   
--------------------------------------------------------------------------------
0          44.1986         85.3416         6.7040          1263.3912       7290      
4          42.3287         86.3856         6.1490          1267.5938       7290      
8          39.9291         87.6543         5.1396          1272.0668       7290      
16         38.1851         88.7454         4.4542          1278.6893       7290      
24         45.4605         89.5087         4.5916          1289.4442       7290      
31         67.9951         84.8466         6.8046          1279.4286       7290      
================================================================================

✓ Analysis complete! Results saved to analysis_results/sameToken_acrossLayers_l2norm/train_mlp-only_pixmo_cap_resize_olmo-7b_siglip_step12000-unsharded
