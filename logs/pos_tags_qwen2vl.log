
================================================================================
Creating combined 3x3 plot for all 9 model combinations
================================================================================
LLMs: ['olmo-7b', 'llama3-8b', 'qwen2-7b']
Vision encoders: ['vit-l-14-336', 'siglip', 'dinov2-large-336']
Sample size: 500 per visual layer
Seed: 42
================================================================================

Loading cached data from /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/layer_evolution/cache/pos_tags_data_visual_s500_seed42.pkl...
  ✓ Loaded 9 cached combinations

Saving data to cache: /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/layer_evolution/cache/pos_tags_data_visual_s500_seed42.pkl
  ✓ Cache saved

Creating combined visualization...

Combined plot saved to: /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/layer_evolution/pos_tags_combined.pdf
Combined plot also saved as PNG: /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/layer_evolution/pos_tags_combined.png

================================================================================
Loading Qwen2-VL-7B-Instruct data...
================================================================================

Loading Qwen2-VL results from /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/contextual_nearest_neighbors/qwen2_vl/Qwen_Qwen2-VL-7B-Instruct...
  Loading visual layer 0...
    Sampling 500 phrases from 377188 total...
    Tagging visual layer 0:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 0:   1%|          | 3/500 [00:00<00:17, 28.85it/s]    Tagging visual layer 0:   6%|▌         | 29/500 [00:00<00:02, 162.47it/s]    Tagging visual layer 0:  12%|█▏        | 61/500 [00:00<00:01, 232.15it/s]    Tagging visual layer 0:  19%|█▊        | 93/500 [00:00<00:01, 264.01it/s]    Tagging visual layer 0:  25%|██▌       | 125/500 [00:00<00:01, 280.32it/s]    Tagging visual layer 0:  31%|███       | 154/500 [00:00<00:01, 183.86it/s]    Tagging visual layer 0:  37%|███▋      | 186/500 [00:00<00:01, 215.07it/s]    Tagging visual layer 0:  44%|████▍     | 219/500 [00:00<00:01, 242.42it/s]    Tagging visual layer 0:  50%|█████     | 251/500 [00:01<00:00, 262.60it/s]    Tagging visual layer 0:  57%|█████▋    | 284/500 [00:01<00:00, 278.91it/s]    Tagging visual layer 0:  63%|██████▎   | 316/500 [00:01<00:00, 290.14it/s]    Tagging visual layer 0:  70%|██████▉   | 348/500 [00:01<00:00, 297.74it/s]    Tagging visual layer 0:  76%|███████▌  | 381/500 [00:01<00:00, 305.22it/s]    Tagging visual layer 0:  83%|████████▎ | 414/500 [00:01<00:00, 310.29it/s]    Tagging visual layer 0:  89%|████████▉ | 447/500 [00:01<00:00, 314.24it/s]    Tagging visual layer 0:  96%|█████████▌| 479/500 [00:01<00:00, 315.55it/s]                                                                                  ✓ Visual layer 0: 500 phrases tagged
  Loading visual layer 16...
    Sampling 500 phrases from 376562 total...
    Tagging visual layer 16:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 16:   5%|▌         | 27/500 [00:00<00:01, 266.67it/s]    Tagging visual layer 16:  12%|█▏        | 59/500 [00:00<00:01, 297.68it/s]    Tagging visual layer 16:  18%|█▊        | 90/500 [00:00<00:01, 300.02it/s]    Tagging visual layer 16:  25%|██▍       | 123/500 [00:00<00:01, 308.95it/s]    Tagging visual layer 16:  31%|███       | 155/500 [00:00<00:01, 312.20it/s]    Tagging visual layer 16:  38%|███▊      | 188/500 [00:00<00:00, 315.64it/s]    Tagging visual layer 16:  44%|████▍     | 221/500 [00:00<00:00, 317.31it/s]    Tagging visual layer 16:  51%|█████     | 253/500 [00:00<00:00, 316.19it/s]    Tagging visual layer 16:  57%|█████▋    | 286/500 [00:00<00:00, 319.87it/s]    Tagging visual layer 16:  64%|██████▍   | 319/500 [00:01<00:00, 321.15it/s]    Tagging visual layer 16:  70%|███████   | 352/500 [00:01<00:00, 322.77it/s]    Tagging visual layer 16:  77%|███████▋  | 385/500 [00:01<00:00, 321.10it/s]    Tagging visual layer 16:  84%|████████▎ | 418/500 [00:01<00:00, 322.26it/s]    Tagging visual layer 16:  90%|█████████ | 451/500 [00:01<00:00, 323.64it/s]    Tagging visual layer 16:  97%|█████████▋| 484/500 [00:01<00:00, 324.89it/s]                                                                                   ✓ Visual layer 16: 500 phrases tagged
  Loading visual layer 1...
    Sampling 500 phrases from 376942 total...
    Tagging visual layer 1:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 1:   6%|▌         | 31/500 [00:00<00:01, 308.00it/s]    Tagging visual layer 1:  13%|█▎        | 64/500 [00:00<00:01, 315.89it/s]    Tagging visual layer 1:  19%|█▉        | 97/500 [00:00<00:01, 320.06it/s]    Tagging visual layer 1:  26%|██▌       | 130/500 [00:00<00:01, 322.18it/s]    Tagging visual layer 1:  33%|███▎      | 163/500 [00:00<00:01, 322.47it/s]    Tagging visual layer 1:  39%|███▉      | 196/500 [00:00<00:00, 312.64it/s]    Tagging visual layer 1:  46%|████▌     | 228/500 [00:00<00:00, 314.07it/s]    Tagging visual layer 1:  52%|█████▏    | 261/500 [00:00<00:00, 316.39it/s]    Tagging visual layer 1:  59%|█████▉    | 294/500 [00:00<00:00, 318.53it/s]    Tagging visual layer 1:  65%|██████▌   | 326/500 [00:01<00:00, 318.85it/s]    Tagging visual layer 1:  72%|███████▏  | 359/500 [00:01<00:00, 320.06it/s]    Tagging visual layer 1:  78%|███████▊  | 392/500 [00:01<00:00, 319.71it/s]    Tagging visual layer 1:  85%|████████▌ | 425/500 [00:01<00:00, 322.51it/s]    Tagging visual layer 1:  92%|█████████▏| 458/500 [00:01<00:00, 324.49it/s]    Tagging visual layer 1:  98%|█████████▊| 491/500 [00:01<00:00, 323.79it/s]                                                                                  ✓ Visual layer 1: 500 phrases tagged
  Loading visual layer 24...
    Sampling 500 phrases from 377692 total...
    Tagging visual layer 24:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 24:   6%|▌         | 28/500 [00:00<00:01, 273.96it/s]    Tagging visual layer 24:  12%|█▏        | 61/500 [00:00<00:01, 301.60it/s]    Tagging visual layer 24:  19%|█▉        | 94/500 [00:00<00:01, 310.50it/s]    Tagging visual layer 24:  25%|██▌       | 127/500 [00:00<00:01, 315.04it/s]    Tagging visual layer 24:  32%|███▏      | 159/500 [00:00<00:01, 311.36it/s]    Tagging visual layer 24:  38%|███▊      | 192/500 [00:00<00:00, 315.96it/s]    Tagging visual layer 24:  45%|████▌     | 225/500 [00:00<00:00, 320.09it/s]    Tagging visual layer 24:  52%|█████▏    | 258/500 [00:00<00:00, 322.39it/s]    Tagging visual layer 24:  58%|█████▊    | 291/500 [00:00<00:00, 323.71it/s]    Tagging visual layer 24:  65%|██████▍   | 324/500 [00:01<00:00, 323.44it/s]    Tagging visual layer 24:  71%|███████▏  | 357/500 [00:01<00:00, 323.46it/s]    Tagging visual layer 24:  78%|███████▊  | 390/500 [00:01<00:00, 324.49it/s]    Tagging visual layer 24:  85%|████████▍ | 423/500 [00:01<00:00, 324.84it/s]    Tagging visual layer 24:  91%|█████████ | 456/500 [00:01<00:00, 325.16it/s]    Tagging visual layer 24:  98%|█████████▊| 490/500 [00:01<00:00, 327.24it/s]                                                                                   ✓ Visual layer 24: 500 phrases tagged
  Loading visual layer 26...
    Sampling 500 phrases from 371270 total...
    Tagging visual layer 26:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 26:   6%|▌         | 31/500 [00:00<00:01, 307.42it/s]    Tagging visual layer 26:  12%|█▏        | 62/500 [00:00<00:01, 307.37it/s]    Tagging visual layer 26:  19%|█▉        | 94/500 [00:00<00:01, 304.23it/s]    Tagging visual layer 26:  25%|██▌       | 126/500 [00:00<00:01, 310.01it/s]    Tagging visual layer 26:  32%|███▏      | 159/500 [00:00<00:01, 314.45it/s]    Tagging visual layer 26:  38%|███▊      | 192/500 [00:00<00:00, 318.53it/s]    Tagging visual layer 26:  45%|████▌     | 225/500 [00:00<00:00, 320.78it/s]    Tagging visual layer 26:  52%|█████▏    | 258/500 [00:00<00:00, 320.97it/s]    Tagging visual layer 26:  58%|█████▊    | 291/500 [00:00<00:00, 319.21it/s]    Tagging visual layer 26:  65%|██████▍   | 323/500 [00:01<00:00, 318.02it/s]    Tagging visual layer 26:  71%|███████   | 356/500 [00:01<00:00, 319.69it/s]    Tagging visual layer 26:  78%|███████▊  | 389/500 [00:01<00:00, 320.17it/s]    Tagging visual layer 26:  84%|████████▍ | 422/500 [00:01<00:00, 322.08it/s]    Tagging visual layer 26:  91%|█████████ | 455/500 [00:01<00:00, 322.51it/s]    Tagging visual layer 26:  98%|█████████▊| 488/500 [00:01<00:00, 324.32it/s]                                                                                   ✓ Visual layer 26: 500 phrases tagged
  Loading visual layer 27...
    Sampling 500 phrases from 369577 total...
    Tagging visual layer 27:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 27:   6%|▌         | 29/500 [00:00<00:01, 288.99it/s]    Tagging visual layer 27:  12%|█▏        | 62/500 [00:00<00:01, 309.52it/s]    Tagging visual layer 27:  19%|█▉        | 95/500 [00:00<00:01, 315.68it/s]    Tagging visual layer 27:  26%|██▌       | 128/500 [00:00<00:01, 318.53it/s]    Tagging visual layer 27:  32%|███▏      | 161/500 [00:00<00:01, 320.72it/s]    Tagging visual layer 27:  39%|███▉      | 194/500 [00:00<00:00, 318.55it/s]    Tagging visual layer 27:  45%|████▌     | 226/500 [00:00<00:00, 313.41it/s]    Tagging visual layer 27:  52%|█████▏    | 259/500 [00:00<00:00, 316.58it/s]    Tagging visual layer 27:  58%|█████▊    | 292/500 [00:00<00:00, 319.24it/s]    Tagging visual layer 27:  65%|██████▍   | 324/500 [00:01<00:00, 316.33it/s]    Tagging visual layer 27:  71%|███████▏  | 357/500 [00:01<00:00, 317.85it/s]    Tagging visual layer 27:  78%|███████▊  | 390/500 [00:01<00:00, 320.11it/s]    Tagging visual layer 27:  85%|████████▍ | 423/500 [00:01<00:00, 322.96it/s]    Tagging visual layer 27:  91%|█████████ | 456/500 [00:01<00:00, 323.02it/s]    Tagging visual layer 27:  98%|█████████▊| 489/500 [00:01<00:00, 322.74it/s]                                                                                   ✓ Visual layer 27: 500 phrases tagged
  Loading visual layer 2...
    Sampling 500 phrases from 380018 total...
    Tagging visual layer 2:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 2:   6%|▌         | 30/500 [00:00<00:01, 297.98it/s]    Tagging visual layer 2:  13%|█▎        | 63/500 [00:00<00:01, 314.46it/s]    Tagging visual layer 2:  19%|█▉        | 96/500 [00:00<00:01, 319.81it/s]    Tagging visual layer 2:  26%|██▌       | 128/500 [00:00<00:01, 314.74it/s]    Tagging visual layer 2:  32%|███▏      | 161/500 [00:00<00:01, 316.94it/s]    Tagging visual layer 2:  39%|███▉      | 194/500 [00:00<00:00, 319.24it/s]    Tagging visual layer 2:  45%|████▌     | 226/500 [00:00<00:00, 314.47it/s]    Tagging visual layer 2:  52%|█████▏    | 258/500 [00:00<00:00, 315.54it/s]    Tagging visual layer 2:  58%|█████▊    | 291/500 [00:00<00:00, 318.19it/s]    Tagging visual layer 2:  65%|██████▍   | 323/500 [00:01<00:00, 317.69it/s]    Tagging visual layer 2:  71%|███████   | 356/500 [00:01<00:00, 318.71it/s]    Tagging visual layer 2:  78%|███████▊  | 389/500 [00:01<00:00, 319.92it/s]    Tagging visual layer 2:  84%|████████▍ | 422/500 [00:01<00:00, 320.89it/s]    Tagging visual layer 2:  91%|█████████ | 455/500 [00:01<00:00, 322.32it/s]    Tagging visual layer 2:  98%|█████████▊| 488/500 [00:01<00:00, 323.60it/s]                                                                                  ✓ Visual layer 2: 500 phrases tagged
  Loading visual layer 4...
    Sampling 500 phrases from 381456 total...
    Tagging visual layer 4:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 4:   6%|▌         | 31/500 [00:00<00:01, 306.95it/s]    Tagging visual layer 4:  13%|█▎        | 64/500 [00:00<00:01, 315.97it/s]    Tagging visual layer 4:  19%|█▉        | 96/500 [00:00<00:01, 310.37it/s]    Tagging visual layer 4:  26%|██▌       | 129/500 [00:00<00:01, 316.16it/s]    Tagging visual layer 4:  32%|███▏      | 162/500 [00:00<00:01, 319.14it/s]    Tagging visual layer 4:  39%|███▉      | 195/500 [00:00<00:00, 320.43it/s]    Tagging visual layer 4:  46%|████▌     | 228/500 [00:00<00:00, 320.14it/s]    Tagging visual layer 4:  52%|█████▏    | 261/500 [00:00<00:00, 320.89it/s]    Tagging visual layer 4:  59%|█████▉    | 294/500 [00:00<00:00, 320.22it/s]    Tagging visual layer 4:  65%|██████▌   | 327/500 [00:01<00:00, 320.95it/s]    Tagging visual layer 4:  72%|███████▏  | 360/500 [00:01<00:00, 319.57it/s]    Tagging visual layer 4:  78%|███████▊  | 392/500 [00:01<00:00, 313.74it/s]    Tagging visual layer 4:  85%|████████▍ | 424/500 [00:01<00:00, 312.74it/s]    Tagging visual layer 4:  91%|█████████ | 456/500 [00:01<00:00, 313.32it/s]    Tagging visual layer 4:  98%|█████████▊| 489/500 [00:01<00:00, 315.64it/s]                                                                                  ✓ Visual layer 4: 500 phrases tagged
  Loading visual layer 8...
    Sampling 500 phrases from 375008 total...
    Tagging visual layer 8:   0%|          | 0/500 [00:00<?, ?it/s]    Tagging visual layer 8:   6%|▌         | 30/500 [00:00<00:01, 296.73it/s]    Tagging visual layer 8:  12%|█▏        | 62/500 [00:00<00:01, 305.00it/s]    Tagging visual layer 8:  19%|█▉        | 94/500 [00:00<00:01, 309.49it/s]    Tagging visual layer 8:  25%|██▌       | 126/500 [00:00<00:01, 310.08it/s]    Tagging visual layer 8:  32%|███▏      | 158/500 [00:00<00:01, 311.84it/s]    Tagging visual layer 8:  38%|███▊      | 190/500 [00:00<00:00, 312.33it/s]    Tagging visual layer 8:  44%|████▍     | 222/500 [00:00<00:00, 313.69it/s]    Tagging visual layer 8:  51%|█████     | 254/500 [00:00<00:00, 314.14it/s]    Tagging visual layer 8:  57%|█████▋    | 286/500 [00:00<00:00, 314.29it/s]    Tagging visual layer 8:  64%|██████▎   | 318/500 [00:01<00:00, 313.46it/s]    Tagging visual layer 8:  70%|███████   | 350/500 [00:01<00:00, 314.62it/s]    Tagging visual layer 8:  76%|███████▋  | 382/500 [00:01<00:00, 316.12it/s]    Tagging visual layer 8:  83%|████████▎ | 414/500 [00:01<00:00, 314.60it/s]    Tagging visual layer 8:  89%|████████▉ | 446/500 [00:01<00:00, 312.77it/s]    Tagging visual layer 8:  96%|█████████▌| 478/500 [00:01<00:00, 312.40it/s]                                                                                  ✓ Visual layer 8: 500 phrases tagged
  ✓ Qwen2-VL data added to average computation

Creating average visualization (10 models)...

Average plot saved to: /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/layer_evolution/pos_tags_average_with_qwen2vl.pdf
Average plot also saved as PNG: /home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/analysis_results/layer_evolution/pos_tags_average_with_qwen2vl.png

================================================================================
Combined plot created successfully!
================================================================================
