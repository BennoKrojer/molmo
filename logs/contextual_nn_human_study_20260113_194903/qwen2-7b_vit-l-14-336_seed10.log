======================================================================
CONTEXTUAL NN (WITH IMAGE PRELOADING)
======================================================================
Checkpoint: molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_qwen2-7b_vit-l-14-336_seed10/step12000-unsharded
Contextual dir: molmo_data/contextual_llm_embeddings_vg/Qwen_Qwen2-7B
Visual layers: [0]
Contextual layers: [1, 2, 4, 8, 16, 24, 26, 27]
Images: 36 (indices: [100, 102, 108, 109, 119]...)
Total forward passes: 8 caches Ã— 36 images = 288

======================================================================
LOADING MODEL
======================================================================
  Loading weights...
Traceback (most recent call last):
  File "/home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/scripts/analysis/contextual_nearest_neighbors_allLayers_singleGPU.py", line 455, in <module>
    main()
  File "/home/nlp/users/bkroje/vl_embedding_spaces/third_party/molmo/scripts/analysis/contextual_nearest_neighbors_allLayers_singleGPU.py", line 227, in main
    weights = torch.load(ckpt_file, map_location="cpu")
  File "/home/nlp/users/bkroje/vl_embedding_spaces/env/lib/python3.10/site-packages/torch/serialization.py", line 1025, in load
    return _load(opened_zipfile,
  File "/home/nlp/users/bkroje/vl_embedding_spaces/env/lib/python3.10/site-packages/torch/serialization.py", line 1446, in _load
    result = unpickler.load()
  File "/home/nlp/users/bkroje/vl_embedding_spaces/env/lib/python3.10/site-packages/torch/serialization.py", line 1416, in persistent_load
    typed_storage = load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/nlp/users/bkroje/vl_embedding_spaces/env/lib/python3.10/site-packages/torch/serialization.py", line 1381, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch.UntypedStorage)._typed_storage()._untyped_storage
RuntimeError: [enforce fail at alloc_cpu.cpp:117] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 543162368 bytes. Error code 12 (Cannot allocate memory)
