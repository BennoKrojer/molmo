======================================================================
CONTEXTUAL NN (WITH IMAGE PRELOADING)
======================================================================
Checkpoint: molmo_data/checkpoints/train_mlp-only_pixmo_cap_resize_llama3-8b_vit-l-14-336/step12000-unsharded
Contextual dir: molmo_data/contextual_llm_embeddings_vg/meta-llama_Meta-Llama-3-8B
Visual layers: [0, 1, 16, 2, 24, 30, 31, 4, 8]
Contextual layers: [1, 2, 4, 8, 16, 24, 30, 31]
Images: 36 (indices: [100, 102, 108, 109, 119]...)
Total forward passes: 8 caches × 36 images = 288

======================================================================
LOADING MODEL
======================================================================
  Loading weights...
  Moving to GPU (fp16)...
✓ Model loaded in 174.8s

======================================================================
PRELOADING IMAGES TO GPU
======================================================================
  Loading 36 images directly to GPU...
    0/36 (image 100)...
    10/36 (image 155)...
    20/36 (image 234)...
    30/36 (image 284)...
✓ Images preloaded in 1.9s (19.3 img/s)

======================================================================
CONTEXTUAL LAYER 1 (1/8)
======================================================================
  Loading cache to GPU... done (5.4s, 417315 embeddings on GPU)
  Processing 36 images (from GPU)...
    Image 1/36 (idx=100) (110376.4 img/s)
    Image 6/36 (idx=134) (1.1 img/s)
    Image 11/36 (idx=155) (0.9 img/s)
    Image 16/36 (idx=191) (0.9 img/s)
    Image 21/36 (idx=234) (0.9 img/s)
    Image 26/36 (idx=257) (0.8 img/s)
    Image 31/36 (idx=284) (0.8 img/s)
    Image 36/36 (idx=299) (0.8 img/s)
  ✓ Done: 36 images in 44.8s (0.8 img/s)
======================================================================
CONTEXTUAL LAYER 2 (2/8)
======================================================================
  Loading cache to GPU... done (5.9s, 415651 embeddings on GPU)
  Processing 36 images (from GPU)...
    Image 1/36 (idx=100) (58254.2 img/s)
    Image 6/36 (idx=134) (1.1 img/s)
    Image 11/36 (idx=155) (0.9 img/s)
    Image 16/36 (idx=191) (0.9 img/s)
    Image 21/36 (idx=234) (0.9 img/s)
    Image 26/36 (idx=257) (0.8 img/s)
    Image 31/36 (idx=284) (0.8 img/s)
    Image 36/36 (idx=299) (0.8 img/s)
  ✓ Done: 36 images in 45.1s (0.8 img/s)
======================================================================
CONTEXTUAL LAYER 4 (3/8)
======================================================================
  Loading cache to GPU... 